---
# Usage: ansible-playbook windows_service_account_rights.yml -e "target_hosts=production"
# Or:    ansible-playbook windows_service_account_rights.yml -e "target_hosts=sql_servers"
# Or:    ansible-playbook windows_service_account_rights.yml -e "target_hosts=development:staging"
#
# To remove user rights for a service:
#   set state: absent for that service assignment.

- name: Configure Windows Service Account User Rights
  hosts: "{{ target_hosts }}"
  gather_facts: false

  vars:
    # Customize these variables as needed.
    # Each item is one Windows service + desired rights state for the account that runs it.
    windows_service_account_rights_assignments:
      - service_name: MSSQLSERVER
        state: present
        rights:
          - SeServiceLogonRight
          - SeManageVolumePrivilege
          - SeLockMemoryPrivilege

      - service_name: SQLSentryServer
        state: present
        rights:
          - SeServiceLogonRight

      - service_name: IgnitePl
        state: present
        rights:
          - SeServiceLogonRight

  roles:
    - windows_service_account_rights

  # Example: remove two rights from MSSQLSERVER (uncomment to use)
  # vars:
  #   windows_service_account_rights_assignments:
  #     - service_name: MSSQLSERVER
  #       state: absent
  #       rights:
  #         - SeManageVolumePrivilege
  #         - SeLockMemoryPrivilege
